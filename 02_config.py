#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
=========================================================================
02_config.py - POSSIM Customer Priority Maker 設定ファイル
=========================================================================

【このファイルの役割】
すべての定数、ファイルパス、設定値を一箇所にまとめて管理します。
月次実行時は、ここの日付を変更するだけで全体が更新されます。

【なぜこうするのか】
設定を1箇所にまとめることで、変更が簡単になり、ミスが減ります。
例えば、月次実行でファイル名の日付を変更する場合、
このファイルの日付部分だけを修正すれば、全体に反映されます。

【作成者】
KATSUMI KURAHASHI

【最終更新日】
2025-11-05
=========================================================================
"""

from pathlib import Path

# =========================================================================
# 【1】基本ディレクトリ設定
# =========================================================================

# このファイル（02_config.py）がある場所を基準にする
# Path(__file__) = このファイル（02_config.py）のパス
# .parent = 親ディレクトリ（possim_customer_priority/）
BASE_DIR = Path(__file__).parent

# 顧客データが入っているフォルダ
# 例: possim_customer_priority/customer_list/
CUSTOMER_LIST_DIR = BASE_DIR / 'customer_list'

# アンケートデータが入っているフォルダ
# 例: possim_customer_priority/surveys/
SURVEYS_DIR = BASE_DIR / 'surveys'

# 処理結果を出力するフォルダ
# 例: possim_customer_priority/output/
OUTPUT_DIR = BASE_DIR / 'output'

# =========================================================================
# 【2】顧客データファイルのパス
# =========================================================================

# 各期のHubSpotエクスポートデータ（11期分）
# ※ VHC6期はここに含まず、差分計算で取得します
#
# 【なぜVHC6期を除くのか】
# VHC6期の専用ファイルは不正確な可能性があるため、
# 全体データから他の11期分を差し引いて、正確なVHC6期データを取得します。
HUBSPOT_CSV_FILES = {
    'VHC1': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-vhc1-2025-11-04.csv',
    'VHC2': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-vhc2-2025-11-04.csv',
    'VHC3': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-vhc3-2025-11-04.csv',
    'VHC4': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-vhc4-2025-11-04.csv',
    'VHC5': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-vhc5-2025-11-04.csv',
    'HCU7': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu7-2025-11-04.csv',
    'HCU8': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu8-2025-11-04.csv',
    'HCU9': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu9-2025-11-04.csv',
    'HCU10': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu10-2025-11-04.csv',
    'HCU11': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu11-2025-11-04.csv',
    'HCU12': CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcu12-2025-11-04.csv',
}

# 全期のマスターデータ（都道府県情報などを取得）
# このファイルにはVHC1～HCU12の全期のデータが含まれています
MASTER_DATA_FILE = CUSTOMER_LIST_DIR / 'hubspot-crm-exports-hcuandvhc-2025-11-05.csv'

# =========================================================================
# 【3】アンケートファイルのパス
# =========================================================================

# HCU7～11期の卒業式アンケート（5期分）
#
# 【なぜ7～11期だけなのか】
# 1～6期のアンケートファイルは存在しないため、対象外です。
# 12期はまだ卒業していないため、アンケートファイルがありません。
SURVEY_FILES = {
    7: SURVEYS_DIR / 'HCU7期卒業式アンケート（回答）.xlsx',
    8: SURVEYS_DIR / '★８期生　表彰式アンケート（回答）.xlsx',
    9: SURVEYS_DIR / '9期生　卒業式アンケート（回答）.xlsx',
    10: SURVEYS_DIR / 'HCU10期 卒業式アンケート（回答）.xlsx',
    11: SURVEYS_DIR / 'HCU11期 卒業式アンケート （回答）.xlsx',
}

# =========================================================================
# 【4】期番号マッピング（VHC1=1, HCU12=12）
# =========================================================================

# 各期を数値に変換するための辞書
# 例: 'VHC1' → 1, 'HCU12' → 12
#
# 【なぜ数値に変換するのか】
# 「最後に受講した期」を判定するために、期を数値で比較する必要があります。
# 例: VHC3 (3) < HCU10 (10) なので、HCU10が最後の期
PERIOD_MAPPING = {
    'VHC1': 1,
    'VHC2': 2,
    'VHC3': 3,
    'VHC4': 4,
    'VHC5': 5,
    'VHC6': 6,  # ← 差分計算で取得
    'HCU7': 7,
    'HCU8': 8,
    'HCU9': 9,
    'HCU10': 10,
    'HCU11': 11,
    'HCU12': 12,
}

# =========================================================================
# 【5】都道府県リスト（全47都道府県）
# =========================================================================

# 住所から都道府県を抽出する時に使用
#
# 【なぜ必要か】
# 住所文字列（例: "東京都渋谷区..."）から都道府県名だけを取り出すため、
# 全都道府県のリストを用意しておきます。
PREFECTURES = [
    '北海道',
    '青森県', '岩手県', '宮城県', '秋田県', '山形県', '福島県',
    '茨城県', '栃木県', '群馬県', '埼玉県', '千葉県', '東京都', '神奈川県',
    '新潟県', '富山県', '石川県', '福井県', '山梨県', '長野県',
    '岐阜県', '静岡県', '愛知県', '三重県',
    '滋賀県', '京都府', '大阪府', '兵庫県', '奈良県', '和歌山県',
    '鳥取県', '島根県', '岡山県', '広島県', '山口県',
    '徳島県', '香川県', '愛媛県', '高知県',
    '福岡県', '佐賀県', '長崎県', '熊本県', '大分県', '宮崎県', '鹿児島県', '沖縄県'
]

# =========================================================================
# 【6】地域別集計の定義
# =========================================================================

# 優先地域のグルーピング
#
# 【なぜこれらの地域を分けるのか】
# 東京都とその近隣県（埼玉・千葉・神奈川）は、
# 営業活動の優先エリアとして別途集計します。
TOKYO = ['東京都']
KANTO_NEARBY = ['埼玉県', '千葉県', '神奈川県']

# 優先順位計算に使用する期の定義
PRIORITY_1_PERIOD = 12  # 優先順位1: 12期生
PRIORITY_2_PERIOD_MIN = 7  # 優先順位2～3: 7期以降
PRIORITY_2_PERIOD_MAX = 11

# =========================================================================
# 【7】出力ファイル設定
# =========================================================================

# 出力Excelファイル名
OUTPUT_FILE = OUTPUT_DIR / 'POSSIM_営業リスト_優先順位付き.xlsx'

# Excelシート名
#
# 【シート構成】
# - MAIN: メインの営業リスト（優先順位付き）
# - REGIONAL: 地域別集計結果（東京都、近隣県など）
# - PRIORITY: 優先順位別の人数集計
# - CHECK: データ品質チェック結果（欠損率など）
OUTPUT_SHEETS = {
    'MAIN': '営業リスト',
    'REGIONAL': '地域別集計結果',
    'PRIORITY': '優先順位別の人数',
    'CHECK': '各種チェック項目',
}

# =========================================================================
# 【8】CSVエンコーディング設定
# =========================================================================

# CSVファイルの文字エンコーディング
# utf-8-sig = BOM付きUTF-8（HubSpotのエクスポート形式）
CSV_ENCODING = 'utf-8-sig'

# Excelファイルのエンジン
# openpyxl = xlsx形式のファイルを扱うライブラリ
EXCEL_ENGINE = 'openpyxl'

# =========================================================================
# 【9】優先順位のラベル定義
# =========================================================================

# 優先順位の説明文
#
# 【優先順位の定義】
# 1: 12期生（最優先）
# 2: 7～11期 + アンケート回答者（次に優先）
# 3: 7～11期 + 未回答（その次）
# 4: 1～6期（低優先）
#
# 【なぜこの順番なのか】
# - 12期生は最新の受講生なので、最も優先度が高い
# - 7～11期でアンケート回答者は、関係性が強いと判断
# - 1～6期は受講から時間が経っているため、優先度は低い
PRIORITY_LABELS = {
    1: '優先順位1（12期生）',
    2: '優先順位2（7～11期 + アンケート回答）',
    3: '優先順位3（7～11期 + 未回答）',
    4: '優先順位4（1～6期）',
}
